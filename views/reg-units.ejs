<%- include("./partials/header.ejs") %>
    <%- include("./partials/nav.ejs") %>
        <div class="container-fluid py-4">
            <div class="row">
                <div class="col-lg-8 col-12">
                    <div class="card">
                        <div class="card-header p-3">
                            <div class="row">
                                <div class="col-md-7">
                                    <h4 class="mb-0 font-weight-bolder text-dark text-gradient">Units on offer</h4>
                                    <span class="badge badge-info ms-auto">{{period}}</span>
                                </div>
                                <div ng-hide="((regUnits | filter: period).length) >= 8 || (currentSemFeeStatement.academics.paid < (0.4 * currentSemFeeStatement.academics.payable))"
                                    class="col-md-5 d-flex justify-content-end align-items-center position-relative">
                                    <h4 class="my-auto">
                                        <span class="text-secondary text-sm me-1">Max</span>8<span
                                            class="text-secondary text-sm ms-1">/ sem </span>
                                    </h4>
                                    <a ng-click="regCourseUnits()" id="btn-regUnits" href="#"
                                        class="btn btn-outline-dark mb-0 ms-auto">Apply Selected
                                    </a>
                                </div>
                            </div>
                            <hr class="horizontal dark mb-0">
                        </div>
                        <div class="card-body p-3 pt-0 table-responsive">
                            <div id="offered-units-table" hidden="">
                                <ul class="list-group list-group-flush rspv" data-toggle="checklist">
                                    <li ng-repeat="s in offeredUnits | filter:'<%= user.course %>' | filter: period | filter:mySearch"
                                        class="list-group-item border-0 flex-column align-items-start ps-0 py-0 mb-3">
                                        <div class="checklist-item checklist-item-info ps-2 ms-3">
                                            <div class="d-flex align-items-center">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox"
                                                        value="{{s.offeredunits._id}}" name="unitRegCheck"
                                                        id="unitRegCheck">
                                                </div>
                                                <h6 class="mb-0 text-dark font-weight-bold text-sm">{{s.units.code}}
                                                    {{s.units.name}}</h6>
                                            </div>
                                            <div
                                                class="d-flex justify-content-between align-items-center ms-4 mt-3 ps-1">
                                                <div>
                                                    <p class="text-xs mb-0 text-secondary font-weight-bold">Session</p>
                                                    <span class="text-xs font-weight-bolder">{{s.units.session}}</span>
                                                </div>
                                                <div class="mx-auto">
                                                    <p class="text-xs mb-0 text-secondary font-weight-bold">Lecturer</p>
                                                    <span class="text-xs font-weight-bolder">{{s.users.title}}.
                                                        {{s.users.fname}}
                                                        {{s.users.lname}}</span>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-12 mt-4 mt-lg-0">
                    <div class="card">
                        <div class="card-header p-3 pb-0">
                            <div class="row">
                                <div class="col-8 d-flex">
                                    <div class="d-flex flex-column justify-content-center">
                                        <h6 class="font-weight-bolder text-dark text-gradient mb-0">
                                            Hey <%= user.fname %>!
                                        </h6>
                                        <p class="text-xs">
                                            <%= user.email %>
                                        </p>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <span class="badge bg-gradient-primary ms-auto float-end">
                                        Student
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="card-body p-3 pt-1">
                            <div ng-repeat="s in courses | filter: '<%= user.course %>'">
                                <h6>{{s.faculties.name}}</h6>
                                <p class="text-sm">{{s.faculties.description}}</p>
                            </div>
                            <div class="d-flex bg-gray-100 border-radius-lg p-3">
                                <a data-bs-toggle="modal" data-bs-target="#modalRegSemester" href="javascript:;"
                                    class="btn bg-gradient-dark mb-0 ms-auto">Register Semester</a>
                            </div>
                        </div>
                    </div>
                    <div class="card overflow-hidden mt-4">
                        <div class="card-body p-3">
                            <div class="row">
                                <div class="col-lg-5">
                                    <div class="d-flex">
                                        <div class="ms-3">
                                            <p class="text-sm mb-0 text-capitalize font-weight-bold">Units</p>
                                            <h5 class="font-weight-bolder mb-0">
                                                {{units.length}}
                                            </h5>
                                        </div>
                                    </div>
                                    <span class="badge badge-dot d-block text-start pb-0 mt-3">
                                        <i class="bg-gradient-info"></i>
                                        <span class="text-muted text-xs font-weight-bold">Completed</span>
                                    </span>
                                    <span class="badge badge-dot d-block text-start">
                                        <i class="bg-gradient-secondary"></i>
                                        <span class="text-muted text-xs font-weight-bold">Pending</span>
                                    </span>
                                </div>
                                <div class="col-lg-7 my-auto">
                                    <div class="chart ms-auto">
                                        <canvas id="chart-bar" class="chart-canvas"
                                            style="display: block; box-sizing: border-box; height: 150px; width: 153.5px;"
                                            width="153" height="150"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <footer class="footer py-5">
                <div class="container">
                    <div class="row">
                        <div class="col-8 mx-auto text-center mt-1">
                            <small class="mb-0 text-secondary">
                                Copyright
                                <script>
                                    document.write(new Date().getFullYear())
                                </script> &copy; All rights reserved
                            </small>
                        </div>
                    </div>
                </div>
            </footer>
        </div>

        <div class="modal fade" id="modalRegSemester" tabindex="-1" role="dialog" aria-labelledby="modalRegSemester"
            aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-sm" role="document">
                <div class="modal-content">
                    <div class="modal-body p-0">
                        <div class="card card-plain">
                            <div class="card-header pb-0 text-left">
                                <h4 class="font-weight-bolder text-dark text-gradient">Register Semester</h4>
                                <span class="badge badge-secondary ms-auto">{{period}}</span>
                            </div>
                            <div class="card-body pb-3">
                                <form id="unitForm" name="unitForm" role="form text-left" novalidate>
                                    <div class="row mt-3">
                                        <div class="col-12 col-sm-12">
                                            <label>Semester Session</label>
                                            <select ng-model="session" class="form-control validate" name="session"
                                                id="session" placeholder="Unit Session" required>
                                                <option value="" selected="" disabled>Session</option>
                                                <option value="1st Year 1st Sem">1st Year 1st Sem</option>
                                                <option value="1st Year 2nd Sem">1st Year 2nd Sem</option>
                                                <option value="2nd Year 1st Sem">2nd Year 1st Sem</option>
                                                <option value="2nd Year 2nd Sem">2nd Year 2nd Sem</option>
                                                <option value="3rd Year 1st Sem">3rd Year 1st Sem</option>
                                                <option value="3rd Year 2nd Sem">3rd Year 2nd Sem</option>
                                                <option value="4th Year 1st Sem">4th Year 1st Sem</option>
                                                <option value="4th Year 2nd Sem">4th Year 2nd Sem</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-check form-check-info text-left pt-4">
                                        <input ng-model="hostel" name="hostel" class="form-check-input" type="checkbox"
                                            id="hostel">
                                        <label class="form-check-label" for="hostel">
                                            Hostel & Accomodation</a>
                                        </label>
                                    </div>
                                    <div class=" mt-4">
                                        <button ng-click="regSemester()" ng-disabled="unitForm.session.$invalid"
                                            id="btn-regSemester"
                                            class="btn bg-gradient-primary btn-tooltip ms-auto mb-0" type="submit"
                                            data-bs-toggle="toooltip" data-bs-placement="bottom"
                                            data-bs-original-title="You will be able to click this button after 40% current semister fees has been paid">Submit</button>
                                    </div>
                                </form>
                            </div>
                            <div class="card-footer text-secondary pt-0 px-sm-4 px-1">
                                <small style="font-size: 13px;">&copy; By using this website, you agree to be bound by,
                                    <a href="#" class="text-primary text-gradient" data-container="body"
                                        data-bs-toggle="popover" data-bs-placement="left"
                                        data-bs-content="
                                            1. Acceptance of Terms and Conditions. These terms and conditions (“Terms and Conditions”) govern your use of this website, including all pages within this website (collectively referred to herein below as this “Website”). These Terms & Conditions are binding and enforceable against all persons that access this Website. By accessing this Website, you acknowledge that you have read, understand, and agree, without limitation or qualification, to be bound by these Terms and Conditions.
                                            2. Modification of Terms and Conditions. We reserve the right to change these Terms and Conditions at any time. Such changes, modifications, additions or deletions shall be effective immediately upon notice thereof, which may be given by means including, but not limited to, posting on this Website. Any use of this Website by you after such notice shall be deemed to constitute acceptance by you of such changes, modifications or additions.
                                            3. Use of Website. This Website is owned and operated by us. You may not copy, reproduce" data-container="body"
                                        data-animation="true">Terms & Conditions</a> set
                                    forth.</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <%- include("./partials/footer.ejs") %>

            <script>
                //if (document.getElementById('session')) {
                //    var element = document.getElementById('session');
                //    const example = new Choices(element, {});
                //}


                var ctx2 = document.getElementById("chart-bar").getContext("2d");

                new Chart(ctx2, {
                    type: "doughnut",
                    data: {
                        labels: ['Completed', 'Pending'],
                        datasets: [{
                            label: "Units",
                            weight: 9,
                            cutout: 50,
                            tension: 0.9,
                            pointRadius: 2,
                            borderWidth: 2,
                            backgroundColor: ['#17c1e8', '#a8b8d8'],
                            data: [75, 25],
                            fill: false
                        }],
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false,
                            }
                        },
                        interaction: {
                            intersect: false,
                            mode: 'index',
                        },
                        scales: {
                            y: {
                                grid: {
                                    drawBorder: false,
                                    display: false,
                                    drawOnChartArea: false,
                                    drawTicks: false,
                                },
                                ticks: {
                                    display: false
                                }
                            },
                            x: {
                                grid: {
                                    drawBorder: false,
                                    display: false,
                                    drawOnChartArea: false,
                                    drawTicks: false,
                                },
                                ticks: {
                                    display: false,
                                }
                            },
                        },
                    },
                });
            </script>