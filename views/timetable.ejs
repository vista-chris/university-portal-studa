<%- include("./partials/header.ejs") %>
    <%- include("./partials/nav.ejs") %>
        <div class="container-fluid py-4">
            <div class="d-sm-flex justify-content-between">
                <div>
                    <a ng-click="generateTimetable()" id="btn-generateTimetable" href="#"
                        class="btn btn-icon bg-gradient-dark">
                        Generate Timetable
                    </a>
                </div>
                <div class="d-flex">
                    <div class="dropdown d-inline">
                        <a href="javascript:;" class="btn btn-outline-dark dropdown-toggle" data-bs-toggle="dropdown"
                            id="navbarDropdownMenuLink2" aria-expanded="false">
                            Filters
                        </a>
                        <ul class="dropdown-menu dropdown-menu-lg-start px-2 py-3"
                            aria-labelledby="navbarDropdownMenuLink2" style="">
                            <li ng-repeat="s in courses"><a ng-click="btnFilter(s.courses.code)"
                                    class="dropdown-item border-radius-md" href="javascript:;">{{s.courses.code}}</a>
                            </li>
                            <li>
                                <hr class="horizontal dark my-2">
                            </li>
                            <li><a ng-click="deleteTimetable()" class="dropdown-item border-radius-md text-danger"
                                    href="javascript:;">Delete Timetable</a></li>
                        </ul>
                    </div>
                    <button onclick="printTimetable()" class="btn btn-icon btn-outline-dark ms-2" data-type="csv"
                        type="button">
                        <span class="btn-inner--icon"><i class="fa-solid fa-print"></i></span>
                        <span class="btn-inner--text">Print</span>
                    </button>
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h4 class="font-weight-bolder text-dark text-gradient">University timetable</h4>
                            <span class="badge badge-info ms-auto">{{period}}</span>
                        </div>
                        <div class="dataTable-wrapper dataTable-loading no-footer sortable searchable fixed-columns">
                            <div class="dataTable-container table-responsive">
                                <table border="1" cellpadding="3" class="table table-hover table-flush table-bordered"
                                    id="timetable" hidden="">
                                    <thead class="thead-light">
                                        <tr>
                                            <th>Weekday</th>
                                            <th>1<br>08:00 AM - 11:00 AM</th>
                                            <th>2<br>11:00 AM - 02:00 PM</th>
                                            <th>3<br>02:00 PM - 05:00 PM</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="text-xs font-weight-bold text-uppercase">
                                                <p class="text-xs text-secondary py-3">Monday</p>
                                            </td>
                                            <td class="text-xs font-weight-bold">
                                                <div ng-repeat="s in timetable | filter: 'Monday' | filter: '08:00 AM' | filter: '11:00 AM' | filter: mySearch"
                                                    class="d-flex align-items-center py-3">
                                                    <div class="flex-column">
                                                        <p class="text-xs text-secondary mb-2">{{s.units.code}}</p>
                                                        <p class="text-xs font-weight-bold text-dark mb-2">
                                                            {{s.units.name}} ({{s.halls.name}})</p>
                                                        <p class="text-xs text-secondary mb-0">
                                                            {{s.courses.code}} - {{s.users.title}}.
                                                            {{s.users.fname}}
                                                            {{s.users.lname}}</p>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="text-xs font-weight-bold">
                                                <div ng-repeat="s in timetable | filter: 'Monday' | filter: '11:00 AM' | filter: '02:00 PM' | filter: mySearch"
                                                    class="d-flex align-items-center py-3">
                                                    <div class="flex-column">
                                                        <p class="text-xs text-secondary mb-1">{{s.units.code}}</p>
                                                        <p class="text-xs font-weight-bold text-dark mb-2">
                                                            {{s.units.name}} ({{s.halls.name}})</p>
                                                        <p class="text-xs text-secondary mb-0">
                                                            {{s.courses.code}} - {{s.users.title}}.
                                                            {{s.users.fname}}
                                                            {{s.users.lname}}</p>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="text-xs font-weight-bold">
                                                <div ng-repeat="s in timetable | filter: 'Monday' | filter: '02:00 PM' | filter: '05:00 PM' | filter: mySearch"
                                                    class="d-flex align-items-center py-3">
                                                    <div class="flex-column">
                                                        <p class="text-xs text-secondary mb-2">{{s.units.code}}</p>
                                                        <p class="text-xs font-weight-bold text-dark mb-2">
                                                            {{s.units.name}} ({{s.halls.name}})</p>
                                                        <p class="text-xs text-secondary mb-0">
                                                            {{s.courses.code}} - {{s.users.title}}.
                                                            {{s.users.fname}}
                                                            {{s.users.lname}}</p>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-xs font-weight-bold text-uppercase">
                                                <p class="text-xs text-secondary py-3">Tuesday</p>
                                            </td>
                                            <td class="text-xs font-weight-bold">
                                                <div ng-repeat="s in timetable | filter: 'Tuesday' | filter: '08:00 AM' | filter: '11:00 AM' | filter: mySearch"
                                                    class="d-flex align-items-center py-3">
                                                    <div class="flex-column">
                                                        <p class="text-xs text-secondary mb-2">{{s.units.code}}</p>
                                                        <p class="text-xs font-weight-bold text-dark mb-2">
                                                            {{s.units.name}} ({{s.halls.name}})</p>
                                                        <p class="text-xs text-secondary mb-0">
                                                            {{s.courses.code}} - {{s.users.title}}.
                                                            {{s.users.fname}}
                                                            {{s.users.lname}}</p>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="text-xs font-weight-bold">
                                                <div ng-repeat="s in timetable | filter: 'Tuesday' | filter: '11:00 AM' | filter: '02:00 PM' | filter: mySearch"
                                                    class="d-flex align-items-center py-3">
                                                    <div class="flex-column">
                                                        <p class="text-xs text-secondary mb-2">{{s.units.code}}</p>
                                                        <p class="text-xs font-weight-bold text-dark mb-2">
                                                            {{s.units.name}} ({{s.halls.name}})</p>
                                                        <p class="text-xs text-secondary mb-0">
                                                            {{s.courses.code}} - {{s.users.title}}.
                                                            {{s.users.fname}}
                                                            {{s.users.lname}}</p>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="text-xs font-weight-bold">
                                                <div ng-repeat="s in timetable | filter: 'Tuesday' | filter: '02:00 PM' | filter: '05:00 PM' | filter: mySearch"
                                                    class="d-flex align-items-center py-3">
                                                    <div class="flex-column">
                                                        <p class="text-xs text-secondary mb-2">{{s.units.code}}</p>
                                                        <p class="text-xs font-weight-bold text-dark mb-2">
                                                            {{s.units.name}} ({{s.halls.name}})</p>
                                                        <p class="text-xs text-secondary mb-0">
                                                            {{s.courses.code}} - {{s.users.title}}.
                                                            {{s.users.fname}}
                                                            {{s.users.lname}}</p>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-xs font-weight-bold text-uppercase">
                                                <p class="text-xs text-secondary py-3">Wednesday</p>
                                            </td>
                                            <td class="text-xs font-weight-bold">
                                                <div ng-repeat="s in timetable | filter: 'Wednesday' | filter: '08:00 AM' | filter: '11:00 AM' | filter: mySearch"
                                                    class="d-flex align-items-center py-3">
                                                    <div class="flex-column">
                                                        <p class="text-xs text-secondary mb-2">{{s.units.code}}</p>
                                                        <p class="text-xs font-weight-bold text-dark mb-2">
                                                            {{s.units.name}} ({{s.halls.name}})</p>
                                                        <p class="text-xs text-secondary mb-0">
                                                            {{s.courses.code}} - {{s.users.title}}.
                                                            {{s.users.fname}}
                                                            {{s.users.lname}}</p>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="text-xs font-weight-bold">
                                                <div ng-repeat="s in timetable | filter: 'Wednesday' | filter: '11:00 AM' | filter: '02:00 PM' | filter: mySearch"
                                                    class="d-flex align-items-center py-3">
                                                    <div class="flex-column">
                                                        <p class="text-xs text-secondary mb-2">{{s.units.code}}</p>
                                                        <p class="text-xs font-weight-bold text-dark mb-2">
                                                            {{s.units.name}} ({{s.halls.name}})</p>
                                                        <p class="text-xs text-secondary mb-0">
                                                            {{s.courses.code}} - {{s.users.title}}.
                                                            {{s.users.fname}}
                                                            {{s.users.lname}}</p>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="text-xs font-weight-bold">
                                                <div ng-repeat="s in timetable | filter: 'Wednesday' | filter: '02:00 PM' | filter: '05:00 PM' | filter: mySearch"
                                                    class="d-flex align-items-center py-3">
                                                    <div class="flex-column">
                                                        <p class="text-xs text-secondary mb-2">{{s.units.code}}</p>
                                                        <p class="text-xs font-weight-bold text-dark mb-2">
                                                            {{s.units.name}} ({{s.halls.name}})</p>
                                                        <p class="text-xs text-secondary mb-0">
                                                            {{s.courses.code}} - {{s.users.title}}.
                                                            {{s.users.fname}}
                                                            {{s.users.lname}}</p>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-xs font-weight-bold text-uppercase">
                                                <p class="text-xs text-secondary py-3">Thursday</p>
                                            </td>
                                            <td class="text-xs font-weight-bold">
                                                <div ng-repeat="s in timetable | filter: 'Thursday' | filter: '08:00 AM' | filter: '11:00 AM' | filter: mySearch"
                                                    class="d-flex align-items-center py-3">
                                                    <div class="flex-column">
                                                        <p class="text-xs text-secondary mb-2">{{s.units.code}}</p>
                                                        <p class="text-xs font-weight-bold text-dark mb-2">
                                                            {{s.units.name}} ({{s.halls.name}})</p>
                                                        <p class="text-xs text-secondary mb-0">
                                                            {{s.courses.code}} - {{s.users.title}}.
                                                            {{s.users.fname}}
                                                            {{s.users.lname}}</p>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="text-xs font-weight-bold">
                                                <div ng-repeat="s in timetable | filter: 'Thursday' | filter: '11:00 AM' | filter: '02:00 PM' | filter: mySearch"
                                                    class="d-flex align-items-center py-3">
                                                    <div class="flex-column">
                                                        <p class="text-xs text-secondary mb-2">{{s.units.code}}</p>
                                                        <p class="text-xs font-weight-bold text-dark mb-2">
                                                            {{s.units.name}} ({{s.halls.name}})</p>
                                                        <p class="text-xs text-secondary mb-0">
                                                            {{s.courses.code}} - {{s.users.title}}.
                                                            {{s.users.fname}}
                                                            {{s.users.lname}}</p>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="text-xs font-weight-bold">
                                                <div ng-repeat="s in timetable | filter: 'Thursday' | filter: '02:00 PM' | filter: '05:00 PM' | filter: mySearch"
                                                    class="d-flex align-items-center py-3">
                                                    <div class="flex-column">
                                                        <p class="text-xs text-secondary mb-2">{{s.units.code}}</p>
                                                        <p class="text-xs font-weight-bold text-dark mb-2">
                                                            {{s.units.name}} ({{s.halls.name}})</p>
                                                        <p class="text-xs text-secondary mb-0">
                                                            {{s.courses.code}} - {{s.users.title}}.
                                                            {{s.users.fname}}
                                                            {{s.users.lname}}</p>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-xs font-weight-bold text-uppercase">
                                                <p class="text-xs text-secondary py-3">Friday</p>
                                            </td>
                                            <td class="text-xs font-weight-bold">
                                                <div ng-repeat="s in timetable | filter: 'Friday' | filter: '08:00 AM' | filter: '11:00 AM' | filter: mySearch"
                                                    class="d-flex align-items-center py-3">
                                                    <div class="flex-column">
                                                        <p class="text-xs text-secondary mb-2">{{s.units.code}}</p>
                                                        <p class="text-xs font-weight-bold text-dark mb-2">
                                                            {{s.units.name}} ({{s.halls.name}})</p>
                                                        <p class="text-xs text-secondary mb-0">
                                                            {{s.courses.code}} - {{s.users.title}}.
                                                            {{s.users.fname}}
                                                            {{s.users.lname}}</p>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="text-xs font-weight-bold">
                                                <div ng-repeat="s in timetable | filter: 'Friday' | filter: '11:00 AM' | filter: '02:00 PM' | filter: mySearch"
                                                    class="d-flex align-items-center py-3">
                                                    <div class="flex-column">
                                                        <p class="text-xs text-secondary mb-2">{{s.units.code}}</p>
                                                        <p class="text-xs font-weight-bold text-dark mb-2">
                                                            {{s.units.name}} ({{s.halls.name}})</p>
                                                        <p class="text-xs text-secondary mb-0">
                                                            {{s.courses.code}} - {{s.users.title}}.
                                                            {{s.users.fname}}
                                                            {{s.users.lname}}</p>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="text-xs font-weight-bold">
                                                <div ng-repeat="s in timetable | filter: 'Friday' | filter: '02:00 PM' | filter: '05:00 PM' | filter: mySearch"
                                                    class="d-flex align-items-center py-3">
                                                    <div class="flex-column">
                                                        <p class="text-xs text-secondary mb-2">{{s.units.code}}</p>
                                                        <p class="text-xs font-weight-bold text-dark mb-2">
                                                            {{s.units.name}} ({{s.halls.name}})</p>
                                                        <p class="text-xs text-secondary mb-0">
                                                            {{s.courses.code}} - {{s.users.title}}.
                                                            {{s.users.fname}}
                                                            {{s.users.lname}}</p>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr></tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="dataTable-bottom">
                                <div class="dataTable-info">&copy; Timetable Generated by <b class="text-primary text-gradient">Studa.</b></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <footer class="footer py-5">
                <div class="container">
                    <div class="row">
                        <div class="col-8 mx-auto text-center mt-1">
                            <small class="mb-0 text-secondary">
                                Copyright
                                <script>
                                    document.write(new Date().getFullYear())
                                </script> &copy; All rights reserved
                            </small>
                        </div>
                    </div>
                </div>
            </footer>
        </div>

        <%- include("./partials/footer.ejs") %>

            <script>
                function printTimetable() {
                    const divToPrint = document.getElementById("timetable");
                    newWin = window.open("");
                    newWin.document.write(divToPrint.outerHTML);
                    newWin.print();
                    newWin.close();
                }
            </script>